(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{35:function(e,t,a){e.exports=a(66)},56:function(e,t,a){},63:function(e,t){var a=864e5;function n(e){for(var t=600,a=0;a<e.length;a++){if("<1/2h"===e[a])return 30;"<1h"===e[a]?t=60:">1h"===e[a]&&t>100&&(t=90)}return t}function l(e){if(!e)return console.log("incorrect dayArray"),{daysMin:0,daysMinInt:0,daysMax:0,daysMaxInt:0};var t=Date.parse((new Date).toDateString()),n=Date.parse(new Date(e[0]).toDateString()),l=Date.parse(new Date(e[1]).toDateString()),o=(t-n)/a;return console.log((t-l)%a),{daysMin:o,daysMinInt:n,daysMax:(t-l)/a,daysMaxInt:l}}function o(e){var t=e[0];var a=0;return e.forEach(function(e){var n=function(e){return e.lasteaten?Date.parse(new Date(e.lasteaten[1]).toDateString()):0}(e);n>a&&(a=n,t=e)}),console.log(t),t}t.arrayElementInArray=function(e,t){for(var a=0;a<e.length;a++)for(var n=0;n<t.length;n++)if(e[a]===t[n])return!0;return!1},t.slowestFood=n,t.lastEaten=function(e){if(!e)return"-";var t=l(e);console.log(t);var a=t.daysMin,n=t.daysMax;return n<=0&&a<=0?"In "+Math.round(-1*a)+" days":n<=0?"Current":Math.round(n)+" days ago"},t.nextAvailableFreeDay=function(e){var t=o(e);return l(t.lastEaten).daysMaxInt<Date.parse((new Date).toDateString())?0:l(t.lasteaten).daysMax},t.last3weeksFoods=function(e){var t=[],a=!0,n=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(a=(r=s.next()).done);a=!0){var i=r.value;i.lasteaten&&l(i.lasteaten).daysMax<21&&t.push(i)}}catch(c){n=!0,o=c}finally{try{a||null==s.return||s.return()}finally{if(n)throw o}}return t},t.getLatestFood=o,t.sortFoods=function(e,t){var a=[];function n(e,t,a){return e<t?1===a?-1:1:e>t?1===a?1:-1:0}var l=t.filter(function(e){return 0!==e.order}).sort(function(e,t){return t.clicked-e.clicked});return 0===l.length?e:(l.forEach(function(t){"main"===t.name?a=e.sort(function(e,a){return n(e.maintype.toLowerCase(),a.maintype.toLowerCase(),t.order)}):"side"===t.name?a=e.sort(function(e,a){return n(e.sidetype.toLowerCase(),a.sidetype.toLowerCase(),t.order)}):"name"===t.name?a=e.sort(function(e,a){return n(e.name.toLowerCase(),a.name.toLowerCase(),t.order)}):"eaten"===t.name?a=e.sort(function(e,a){return n(e.timeseaten,a.timeseaten,t.order)}):"duration"===t.name?a=e.sort(function(e,a){return n(e.foodamount,a.foodamount,t.order)}):"lasteaten"===t.name&&(a=e.sort(function(e,a){return n(e.lasteaten?Date.parse(e.lasteaten[1]):1/0,a.lasteaten?Date.parse(a.lasteaten[1]):1/0,t.order)}))}),a)},t.getStartAndEndDays=function(e,t,n,l){var r=Date.parse((new Date).toDateString()),s=Date.parse(new Date(o(e).lasteaten[1]).toDateString())+n*a,i=s+(l-1)*a,c=new Date(s).toDateString(),d=new Date(i).toDateString();return console.log("today ms"+r),console.log("start ms"+s),console.log("endDay ms"+i),console.log("startDayString"+c),console.log("endDayString"+d),{obj:t,start:c,end:d}},t.shiftDay=function(e,t){return new Date(Date.parse(new Date(e))+t*a).toDateString()},t.checkSpeedFilter=function(e,t){if(!t)return!0;var a=n(t);return 90===a?e>60:30===a?e<=30:e<=60}},66:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),o=a(11),r=a.n(o),s=a(12),i=a(13),c=a(16),d=a(14),u=a(4),m=a(17),f=a(19),h=a.n(f),E=(a(56),a(30)),g=a(68),v=a(67),w=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).FoodPicker=function(){return console.log("wadup"),l.a.createElement(O,{state:a.state.prevState})},a.state={name:e.name,prevState:e.prevState,return:!1},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return console.log(this.state.prevState),this.state.return?l.a.createElement(O,{state:this.state.prevState}):l.a.createElement("div",null,l.a.createElement("h1",{onClick:function(){return e.setState({return:!0})}},this.state.name))}}]),t}(l.a.Component),b=a(3),p=a(7),x=a(2),y=a(63),F="/api/foods",k=["kala","kana","kasvis","liha"],S=["bataatti","pasta","peruna","riisi","salaatti"],D=["<1/2h","<1h",">1h"],N=[1,2,3],C=function(e){return-1!==k.indexOf(e)?"main":-1!==S.indexOf(e)?"side":Object(E.isNumber)(e)?"day":"speed"};function j(e){return"liha"===e?l.a.createElement(x.a,{icon:b.c}):"kana"===e?l.a.createElement(x.a,{icon:b.g}):"kasvis"===e?l.a.createElement(x.a,{icon:b.h}):"kala"===e?l.a.createElement(x.a,{icon:b.d}):"<1/2h"===e?l.a.createElement(x.a,{icon:p.c}):"<1h"===e?l.a.createElement(x.a,{icon:b.f}):">1h"===e?l.a.createElement(x.a,{icon:b.e}):e}var O=function(e){function t(e){var a,n=this;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).FilterSelected=function(e){return(e?a.getPressedFilters().inc:a.getPressedFilters().exc).map(function(e,t){return l.a.createElement(v.a,{key:t,classNames:"filtered",timeout:{enter:500,exit:300}},l.a.createElement("button",{className:"filter-button",onClick:a.DeactivateFilter.bind(Object(u.a)(a),e),key:t},j(e),l.a.createElement(x.a,{className:"remove-filter",icon:p.d})))})},a.FilterRow=function(e){return l.a.createElement("div",null,l.a.createElement(g.a,null,l.a.createElement(v.a,{key:0,classNames:"filtered",timeout:{enter:500,exit:300}},e.off.length>0?l.a.createElement("i",null,e.name+": "):l.a.createElement("i",{visibilty:"hidden"})),a.CreateRow(e.name,e.off)))},a.CreateRow=function(e,t){return t.map(function(t,n){return l.a.createElement(v.a,{key:n,classNames:"filtered",timeout:{enter:500,exit:300}},l.a.createElement("button",{id:C(e),className:"filter-button",onClick:a.ActivateFilter.bind(Object(u.a)(a),t),key:n},j(t)))})},a.NameLink=function(e){var t=e.food;return""===t.link?l.a.createElement("td",null,t.name):l.a.createElement("td",null,l.a.createElement("a",{href:t.link},t.name))},a.SelectFood=function(){var e=a.state.newFood.obj,t=a.state.newFood.start,n=a.state.newFood.end;e.lasteaten=[new Date(t).toDateString(),new Date(n).toDateString()],h.a.post(F+"/select/",e).then(function(e){a.componentDidMount()}),a.setState({newFoodSelected:!1,dropdown:""})},a.SetFoodParameters=function(){function e(e,t){if(!(this.state.newFood.start===this.state.newFood.end&&e!==t&&t<0)){var a=y.shiftDay(this.state.newFood.start,e),n=y.shiftDay(this.state.newFood.end,t);this.setState({newFood:{obj:this.state.newFood.obj,start:a,end:n}})}}function t(e){var t=new Date(e).getMonth()+1;return new Date(e).getDate()+"."+t}return l.a.createElement("div",{className:"food-adder-content"},l.a.createElement("div",{className:"fa-box"},a.state.newFood.obj.name),l.a.createElement("div",{className:"fa-box"},"Start"),l.a.createElement("i",null),l.a.createElement(x.a,{className:"fa-box",icon:p.a,onClick:e.bind(Object(u.a)(a),-1,-1)}),l.a.createElement("div",{className:"fa-box"},a.state.newFood.start.split(" ")[0]),l.a.createElement(x.a,{className:"fa-box",icon:p.b,onClick:e.bind(Object(u.a)(a),1,1)}),l.a.createElement("i",null),l.a.createElement("div",{className:"fa-box"},t(a.state.newFood.start)),l.a.createElement("div",{className:"fa-box"},"End"),l.a.createElement("i",null),l.a.createElement(x.a,{className:"fa-box",icon:p.a,onClick:e.bind(Object(u.a)(a),0,-1)}),l.a.createElement("div",{className:"fa-box"},a.state.newFood.end.split(" ")[0]),l.a.createElement(x.a,{className:"fa-box",icon:p.b,onClick:e.bind(Object(u.a)(a),0,1)}),l.a.createElement("i",null),l.a.createElement("div",{className:"fa-box"},t(a.state.newFood.end)),l.a.createElement("div",{className:"fa-box",onClick:function(){return a.setState({newFoodSelected:!1,newFood:{obj:null,start:0,end:1},dropdown:""})}},"Cancel"),l.a.createElement("i",null),l.a.createElement("div",{className:"fa-box",onClick:a.SelectFood.bind(Object(u.a)(a))},"Ok"))},a.FoodTable=function(e){return e.foods.map(function(e,t){return l.a.createElement("tr",{key:t},l.a.createElement("td",{className:"maintype_table"},j(e.maintype)),l.a.createElement("td",{className:"sidetype_table"},e.sidetype),l.a.createElement(n.NameLink,{food:e}),a.state.show_timeseaten?l.a.createElement("td",null,e.timeseaten):null,a.state.show_duration?l.a.createElement("td",null,e.foodamount):null,a.state.show_lasteaten?l.a.createElement("td",null,y.lastEaten(e.lasteaten)):null,l.a.createElement("td",{onClick:function(){document.getElementById("food-table").classList.toggle("set-to-background"),a.setState({newFoodSelected:!0,newFood:y.getStartAndEndDays(a.state.foods,e,1,e.foodamount)})}},l.a.createElement(x.a,{icon:b.i,className:"select-food-button"})))})},a.updateTextFilter=function(e){a.setState({textfilter:e.target.value})},a.ToggleButton=function(e){var t=e.name;return l.a.createElement("div",null,l.a.createElement("p",{id:"toggleButton-text",className:"toggleButton-text",onClick:function(e){document.getElementById(e).classList.toggle("active"),document.getElementById("toggleButton-text").classList.toggle("pressed"),"Times Eaten"===e?this.setState({show_timeseaten:!this.state.show_timeseaten}):"Duration"===e?this.setState({show_duration:!this.state.show_duration}):this.setState({show_lasteaten:!this.state.show_lasteaten})}.bind(Object(u.a)(a),t)},t),l.a.createElement("div",{id:t,className:"toggleButton"},l.a.createElement("div",{className:"inner-Circle"})))},a.MenuItem=function(e){var t=e.name,n=e.dropName,o=e.icon;function r(){var e=this.state.dropdown;document.getElementById(n).classList.toggle("is-nav-open"),this.setState({dropdown:e===n?"":n}),e!==n&&e.length>0&&document.getElementById(e).classList.toggle("is-nav-open")}return l.a.createElement("i",{className:"menu-text",onClick:r.bind(Object(u.a)(a),r)},l.a.createElement(x.a,{icon:o})," "+t)},a.TableHeader=function(e){var t=e.name,n=void 0;return a.state.sortBy.forEach(function(e){e.name===t&&(n=e)}),l.a.createElement("th",null,l.a.createElement("i",{className:"table-header",onClick:a.handleSorterClick.bind(Object(u.a)(a),t)},"lasteaten"===t?"Last Eaten":t+" ",1===n.order?l.a.createElement(x.a,{icon:b.l}):2===n.order?l.a.createElement(x.a,{icon:b.m}):l.a.createElement(x.a,{icon:b.k})))},a.state={foods:[],newFoodSelected:!1,newFood:{obj:null,start:0,end:1},filters:[{name:"main",on:{include:[],exclude:[]},off:k},{name:"side",on:{include:[],exclude:[]},off:S},{name:"speed",on:{include:[],exclude:[]},off:D},{name:"day",on:{include:[],exclude:[]},off:N}],textfilter:"",dropdown:"",show_timeseaten:!1,show_duration:!1,show_lasteaten:!1,selectingFood:{bool:!1,newFood:null},sortBy:[{name:"main",clicked:0,order:0},{name:"side",clicked:0,order:0},{name:"name",clicked:0,order:0},{name:"eaten",clicked:0,order:0},{name:"duration",clicked:0,order:0},{name:"lasteaten",clicked:0,order:0}],filterIncludeExclude:!0,shoplist:!1,testVisible:!0},a.SetFoodParameters=a.SetFoodParameters.bind(Object(u.a)(a)),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;console.log("mounttas"),h.a.get(F).then(function(t){var a=y.getLatestFood(t.data).maintype;e.setState({foods:t.data,filters:[{name:"main",on:{include:[],exclude:[a]},off:k.filter(function(e){return e!==a})},{name:"side",on:{include:[],exclude:[]},off:S},{name:"speed",on:{include:[],exclude:[]},off:D},{name:"day",on:{include:[],exclude:[]},off:N}]})});var t=document.getElementById("fading-text");t&&t.classList.toggle("fade")}},{key:"DeactivateFilter",value:function(e,t){for(var a=this.state.filters,n=0;n<a.length;n++)a[n]=a[n].name===C(e)?{name:a[n].name,on:{include:a[n].on.include.filter(function(t){return t!==e}),exclude:a[n].on.exclude.filter(function(t){return t!==e})},off:a[n].off.concat(e).sort()}:a[n];this.setState({filters:a})}},{key:"ActivateFilter",value:function(e){for(var t=this.state.filters,a=0;a<t.length;a++)t[a]=t[a].name===C(e)?{name:t[a].name,on:this.state.filterIncludeExclude?{include:t[a].on.include.concat(e),exclude:t[a].on.exclude}:{include:t[a].on.include,exclude:t[a].on.exclude.concat(e)},off:t[a].off.filter(function(t){return t!==e})}:t[a];this.setState({filters:t})}},{key:"getPressedFilters",value:function(){var e=[],t=[];return this.state.filters.map(function(t){return t.on.include.forEach(function(t){return e.push(t)})}),this.state.filters.map(function(e){return e.on.exclude.forEach(function(e){return t.push(e)})}),{inc:e,exc:t}}},{key:"FilteredFoods",value:function(){var e=this,t={inc:0===this.state.filters[0].on.include.length?this.state.filters[0].off:this.state.filters[0].on.include,exc:this.state.filters[0].on.exclude},a={inc:0===this.state.filters[1].on.include.length?this.state.filters[1].off:this.state.filters[1].on.include,exc:this.state.filters[1].on.exclude},n={inc:0===this.state.filters[3].on.include.length?this.state.filters[3].off:this.state.filters[3].on.include,exc:this.state.filters[3].on.exclude};return this.state.foods.filter(function(l){return-1!==t.inc.indexOf(l.maintype)&&-1===t.exc.indexOf(l.maintype)&&y.arrayElementInArray(l.sidetype.split(", "),a.inc)&&!y.arrayElementInArray(l.sidetype.split(", "),a.exc)&&-1!==n.inc.indexOf(l.foodamount)&&-1===n.exc.indexOf(l.foodamount)&&(e.state.filters[2].off.length===D.length||y.checkSpeedFilter(l.time,e.state.filters[2].on.include)&&(0===e.state.filters[2].on.exclude.length||!y.checkSpeedFilter(l.time,e.state.filters[2].on.exclude)))&&l.name.toLowerCase().includes(e.state.textfilter.toLowerCase())})}},{key:"DropDown",value:function(e){document.getElementById(e).classList.toggle("is-nav-open"),this.setState({dropdown:0===this.state.dropdown.length?e:""})}},{key:"handleSorterClick",value:function(e){for(var t=this.state.sortBy,a=0;a<t.length;a++)t[a]=t[a].name===e?{name:e,clicked:2===t[a].order?0:Date.parse((new Date).toDateString()),order:(t[a].order+1)%3}:t[a];this.setState({foods:y.sortFoods(this.state.foods,t),sortBy:t})}},{key:"render",value:function(){var e=this,t=this.FilterSelected(!0),a=this.FilterSelected(!1),n=this.FilterRow(this.state.filters[0]),o=this.FilterRow(this.state.filters[1]),r=this.FilterRow(this.state.filters[2]),s=this.FilterRow(this.state.filters[3]);return l.a.createElement("div",null,this.state.newFoodSelected?l.a.createElement(this.SetFoodParameters,null):this.state.shoplist?l.a.createElement(w,{name:"hello there",prevState:this.state}):l.a.createElement("div",{id:"main"},l.a.createElement(this.MenuItem,{name:"Filters",dropName:"filtermenu",icon:b.a}),l.a.createElement(this.MenuItem,{name:"Show",dropName:"showmenu",icon:b.j}),l.a.createElement("div",{id:"filtermenu",className:"filtermenu"},l.a.createElement("div",{className:"nav"},l.a.createElement("div",null,"filtermenu"===this.state.dropdown?l.a.createElement("div",null,l.a.createElement("div",{className:"form"},l.a.createElement("form",{className:"form"},l.a.createElement("input",{value:this.state.textfilter,onChange:this.updateTextFilter})),l.a.createElement("div",{className:"form"},l.a.createElement(x.a,{icon:b.n,onClick:function(){e.setState({textfilter:""})}}))),n,o,r,s,l.a.createElement("div",{className:"include-exclude",onClick:function(){console.log(y.getLatestFood(e.state.foods)),e.setState({filterIncludeExclude:!e.state.filterIncludeExclude,shoplist:!0})}},l.a.createElement("div",{className:"include-exclude-inner"},this.state.filterIncludeExclude?l.a.createElement("div",{className:"include"},l.a.createElement(x.a,{icon:b.b}),l.a.createElement("i",null,"Must Include")," "):l.a.createElement("div",{className:"exclude"},l.a.createElement(x.a,{icon:b.n}),l.a.createElement("i",null,"Exclude")," ")))):null))),l.a.createElement("div",{id:"showmenu",className:"showmenu"},"showmenu"===this.state.dropdown?l.a.createElement("div",null,l.a.createElement(this.ToggleButton,{name:"Times Eaten"}),l.a.createElement(this.ToggleButton,{name:"Duration"}),l.a.createElement(this.ToggleButton,{name:"Last Eaten"})):null," "),l.a.createElement("div",null,l.a.createElement(g.a,null,l.a.createElement(v.a,{key:0,classNames:"filtered",timeout:{enter:500,exit:300}},this.getPressedFilters().inc.length>0?l.a.createElement(x.a,{icon:b.b,className:"filtered"}):l.a.createElement("i",null)),t),l.a.createElement(g.a,null,l.a.createElement(v.a,{key:0,classNames:"filtered",timeout:{enter:500,exit:300}},this.getPressedFilters().exc.length>0?l.a.createElement(x.a,{icon:b.n,className:"filtered"}):l.a.createElement("i",null)),a)),l.a.createElement("div",null,this.state.newFood.obj?l.a.createElement("div",{id:"fading-text",className:"fading-text"},l.a.createElement("i",null,"Lets eat: "+this.state.newFood.obj.name)):null,l.a.createElement("table",{id:"food-table",className:"food-table"},l.a.createElement("tbody",null,l.a.createElement("tr",{className:"table-headers"},l.a.createElement(this.TableHeader,{name:"main"}),l.a.createElement(this.TableHeader,{name:"side"}),l.a.createElement(this.TableHeader,{name:"name"}),this.state.show_timeseaten?l.a.createElement(this.TableHeader,{name:"eaten"}):null,this.state.show_duration?l.a.createElement(this.TableHeader,{name:"duration"}):null,this.state.show_lasteaten?l.a.createElement(this.TableHeader,{name:"lasteaten"}):null),l.a.createElement(this.FoodTable,{foods:this.FilteredFoods()}))))))}}]),t}(l.a.Component);r.a.render(l.a.createElement(O,null),document.getElementById("root"))}},[[35,1,2]]]);
//# sourceMappingURL=main.19aae978.chunk.js.map