(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{35:function(e,t,a){e.exports=a(66)},56:function(e,t,a){},63:function(e,t){var a=864e5;function n(e){for(var t=600,a=0;a<e.length;a++)if("<1/2h"===e[a])t=30;else if("<1h"===e[a])t=60;else if(">1h"===e[a])return-1;return t}function o(e){if(!e)return{daysMin:0,daysMinInt:0,daysMax:0,daysMaxInt:0};var t=Date.parse((new Date).toDateString()),n=Date.parse(new Date(e[0]).toDateString()),o=Date.parse(new Date(e[1]).toDateString()),r=(t-n)/a;return console.log((t-o)%a),{daysMin:r,daysMinInt:n,daysMax:(t-o)/a,daysMaxInt:o}}function r(e){return o(s(e).lasteaten).daysMax-1}function s(e){var t=e[0],a=Date.parse(new Date(0).toDateString());return e.forEach(function(e){e.lasteaten&&o(e.lasteaten).daysMaxInt>a&&(a=o(e.lasteaten).daysMaxInt),t=e}),t}t.arrayElementInArray=function(e,t){for(var a=0;a<e.length;a++)for(var n=0;n<t.length;n++)if(e[a]===t[n])return!0;return!1},t.slowestFood=n,t.lastEaten=function(e){if(!e)return"-";var t=o(e);console.log(t);var a=t.daysMin,n=t.daysMax;return n<=0&&a<=0?"In "+Math.round(-1*a)+" days":n<=0?"Current":Math.round(n)+" days ago"},t.nextAvailableFreeDay=r,t.last3weeksFoods=function(e){var t=[],a=!0,n=!1,r=void 0;try{for(var s,l=e[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var i=s.value;i.lasteaten&&o(i.lasteaten).daysMax<21&&t.push(i)}}catch(c){n=!0,r=c}finally{try{a||null==l.return||l.return()}finally{if(n)throw r}}return t},t.getLatestFood=s,t.sortFoods=function(e,t){var a=[];function n(e,t,a){return e<t?1===a?-1:1:e>t?1===a?1:-1:0}var o=t.filter(function(e){return 0!==e.order}).sort(function(e,t){return t.clicked-e.clicked});return 0===o.length?e:(o.forEach(function(t){"main"===t.name?a=e.sort(function(e,a){return n(e.maintype.toLowerCase(),a.maintype.toLowerCase(),t.order)}):"side"===t.name?a=e.sort(function(e,a){return n(e.sidetype.toLowerCase(),a.sidetype.toLowerCase(),t.order)}):"name"===t.name?a=e.sort(function(e,a){return n(e.name.toLowerCase(),a.name.toLowerCase(),t.order)}):"eaten"===t.name?a=e.sort(function(e,a){return n(e.timeseaten,a.timeseaten,t.order)}):"duration"===t.name?a=e.sort(function(e,a){return n(e.foodamount,a.foodamount,t.order)}):"lasteaten"===t.name&&(a=e.sort(function(e,a){return n(e.lasteaten?Date.parse(e.lasteaten[1]):1/0,a.lasteaten?Date.parse(a.lasteaten[1]):1/0,t.order)}))}),a)},t.getStartAndEndDays=function(e,t,n,o){var s=Date.parse((new Date).toDateString()),l=s+(-1*r(e)+n)*a,i=l+o*a,c=new Date(l).toDateString(),d=new Date(i).toDateString();return console.log("today ms"+s),console.log("start ms"+l),console.log("endDay ms"+i),console.log("startDayString"+c),console.log("endDayString"+d),{obj:t,start:c,end:d}},t.shiftDay=function(e,t){return new Date(Date.parse(new Date(e))+t*a).toDateString()},t.checkSpeedFilter=function(e,t){if(!t)return!0;var a=n(t);return a<0?e>60:30===a?e<=30:e<=60}},66:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(11),s=a.n(r),l=a(25),i=a(26),c=a(31),d=a(27),m=a(2),u=a(32),f=a(14),h=a.n(f),E=(a(56),a(28)),w=a(68),g=a(67),v=a(5),y=a(9),b=a(4),p=a(63),F="/api/foods",D=["liha","kana","kala","kasvis"],k=["pasta","peruna","riisi","salaatti","bataatti"],S=["<1/2h","<1h",">1h"],x=[1,2,3],C=function(e){return-1!==D.indexOf(e)?"main":-1!==k.indexOf(e)?"side":Object(E.isNumber)(e)?"day":"speed"};var N=function(e){function t(e){var a,n=this;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).FilterSelected=function(){return a.state.filtersPressed.map(function(e,t){return o.a.createElement(g.a,{key:t,classNames:"filtered",timeout:{enter:500,exit:300}},o.a.createElement("button",{onClick:a.DeactivateFilter.bind(Object(m.a)(a),e),key:t},e))})},a.CreateRow=function(e,t){return t.map(function(e,t){return o.a.createElement(g.a,{key:t,classNames:"filtered",timeout:{enter:500,exit:300}},o.a.createElement("button",{onClick:a.ActivateFilter.bind(Object(m.a)(a),e),key:t},function(e){return"<1/2h"===e?o.a.createElement(b.a,{icon:y.c}):"<1h"===e?o.a.createElement(b.a,{icon:v.d}):">1h"===e?o.a.createElement(b.a,{icon:v.c}):e}(e)))})},a.CreateRow2=function(e,t){return"filtermenu"===a.state.dropName?o.a.createElement("div",null,o.a.createElement(w.a,null,a.CreateRow(e,t))):null},a.NameLink=function(e){var t=e.food;return""===t.link?o.a.createElement("td",null,t.name):o.a.createElement("td",null,o.a.createElement("a",{href:t.link},t.name))},a.SelectFood=function(){var e=a.state.newFood.obj;console.log("syodaan nakojaan "+e.name);var t=a.state.newFood.start,n=a.state.newFood.end;e.lasteaten=[new Date(t).toDateString(),new Date(n).toDateString()],console.log(e),h.a.post(F+"/select/",e).then(function(e){console.log("updated: "+e.data),a.componentDidMount()}),a.setState({newFoodSelected:!1,dropdown:""})},a.SetFoodParameters=function(){function e(e,t){if(this.state.newFood.start!==this.state.newFood.end||!(e>0||t<0)){var a=p.shiftDay(this.state.newFood.start,e),n=p.shiftDay(this.state.newFood.end,t);this.setState({newFood:{obj:this.state.newFood.obj,start:a,end:n}}),console.log(this.state.newFood)}}function t(e){var t=new Date(e).getMonth();return new Date(e).getDate()+"."+t}return o.a.createElement("div",{className:"food-adder-content"},o.a.createElement("div",{className:"fa-box"},a.state.newFood.obj.name),o.a.createElement("div",{className:"fa-box"},"Start"),o.a.createElement("i",null),o.a.createElement(b.a,{className:"fa-box",icon:y.a,onClick:e.bind(Object(m.a)(a),-1,0)}),o.a.createElement("div",{className:"fa-box"},a.state.newFood.start.split(" ")[0]),o.a.createElement(b.a,{className:"fa-box",icon:y.b,onClick:e.bind(Object(m.a)(a),1,0)}),o.a.createElement("i",null),o.a.createElement("div",{className:"fa-box"},t(a.state.newFood.start)),o.a.createElement("div",{className:"fa-box"},"End 2"),o.a.createElement("i",null),o.a.createElement(b.a,{className:"fa-box",icon:y.a,onClick:e.bind(Object(m.a)(a),0,-1)}),o.a.createElement("div",{className:"fa-box"},a.state.newFood.end.split(" ")[0]),o.a.createElement(b.a,{className:"fa-box",icon:y.b,onClick:e.bind(Object(m.a)(a),0,1)}),o.a.createElement("i",null),o.a.createElement("div",{className:"fa-box"},t(a.state.newFood.end)),o.a.createElement("div",{className:"fa-box",onClick:function(){return a.setState({newFoodSelected:!1,dropdown:""})}},"Cancel"),o.a.createElement("i",null),o.a.createElement("div",{className:"fa-box",onClick:a.SelectFood.bind(Object(m.a)(a))},"Ok"))},a.FoodTable=function(e){return e.foods.map(function(e,t){return o.a.createElement("tr",{key:t},o.a.createElement("td",{className:"maintype_table"},e.maintype),o.a.createElement("td",{className:"sidetype_table"},e.sidetype),o.a.createElement(n.NameLink,{food:e}),a.state.show_timeseaten?o.a.createElement("td",null,e.timeseaten):null,a.state.show_duration?o.a.createElement("td",null,e.foodamount):null,a.state.show_lasteaten?o.a.createElement("td",null,p.lastEaten(e.lasteaten)):null,o.a.createElement("td",{onClick:function(){document.getElementById("food-table").classList.toggle("set-to-background"),a.setState({newFoodSelected:!0,newFood:p.getStartAndEndDays(a.state.foods,e,0,e.foodamount)})}},o.a.createElement(b.a,{icon:v.b})))})},a.updateTextFilter=function(e){a.setState({textfilter:e.target.value})},a.ToggleButton=function(e){var t=e.name;return o.a.createElement("div",null,o.a.createElement("p",{id:"toggleButton-text",className:"toggleButton-text",onClick:function(e){document.getElementById(e).classList.toggle("active"),document.getElementById("toggleButton-text").classList.toggle("pressed"),"Times Eaten"===e?this.setState({show_timeseaten:!this.state.show_timeseaten}):"Duration"===e?this.setState({show_duration:!this.state.show_duration}):this.setState({show_lasteaten:!this.state.show_lasteaten})}.bind(Object(m.a)(a),t)},t),o.a.createElement("div",{id:t,className:"toggleButton"},o.a.createElement("div",{className:"inner-Circle"})))},a.MenuItem=function(e){var t=e.name,n=e.dropName,r=e.icon;function s(){console.log(n);var e=this.state.dropdown;console.log(e),document.getElementById(n).classList.toggle("is-nav-open"),this.setState({dropdown:e===n?"":n}),e!==n&&e.length>0&&document.getElementById(e).classList.toggle("is-nav-open")}return o.a.createElement("i",{className:"menu-text",onClick:s.bind(Object(m.a)(a),s)},o.a.createElement(b.a,{icon:r})," "+t)},a.TableHeader=function(e){var t=e.name,n=void 0;return a.state.sortBy.forEach(function(e){e.name===t&&(n=e)}),o.a.createElement("th",null,o.a.createElement("i",{className:"table-header",onClick:a.handleSorterClick.bind(Object(m.a)(a),t)},"lasteaten"===t?"Last Eaten":t+" ",1===n.order?o.a.createElement(b.a,{icon:v.g}):2===n.order?o.a.createElement(b.a,{icon:v.h}):o.a.createElement(b.a,{icon:v.f})))},a.state={foods:[],newFoodSelected:!1,newFood:{obj:null,start:0,end:1},latestfoods:[],filtersPressed:[],filters:[{name:"main",on:[],off:D},{name:"side",on:[],off:k},{name:"speed",on:[],off:S},{name:"day",on:[],off:x}],maintypefilter:{on:[],off:D},sidetypefilter:{on:[],off:k},speedtypefilter:{on:[],off:S},daytypefilter:{on:[],off:x},textfilter:"",dropdown:"",show_timeseaten:!1,show_duration:!1,show_lasteaten:!1,selectingFood:{bool:!1,newFood:null},sortBy:[{name:"main",clicked:0,order:0},{name:"side",clicked:0,order:0},{name:"name",clicked:0,order:0},{name:"eaten",clicked:0,order:0},{name:"duration",clicked:0,order:0},{name:"lasteaten",clicked:0,order:0}]},a.SetFoodParameters=a.SetFoodParameters.bind(Object(m.a)(a)),a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;console.log("mounttas"),h.a.get(F).then(function(t){e.setState({foods:t.data})})}},{key:"DeactivateFilter",value:function(e){for(var t=this.state.filters,a=0;a<t.length;a++)t[a]=t[a].name===C(e)?{name:t[a].name,on:t[a].on.filter(function(t){return t!==e}),off:t[a].off.concat(e)}:t[a];this.setState({filtersPressed:this.state.filtersPressed.filter(function(t){return t!==e}),filters:t})}},{key:"ActivateFilter",value:function(e){for(var t=this.state.filters,a=0;a<t.length;a++)t[a]=t[a].name===C(e)?{name:t[a].name,on:t[a].on.concat(e),off:t[a].off.filter(function(t){return t!==e})}:t[a];this.setState({filtersPressed:this.state.filtersPressed.concat(e),filters:t})}},{key:"FilteredFoods",value:function(){var e=this;if(0===this.state.filtersPressed.length&&0===this.state.textfilter.length)return this.state.foods;var t=0===this.state.filters[0].on.length?this.state.filters[0].off:this.state.filters[0].on,a=0===this.state.filters[1].on.length?this.state.filters[1].off:this.state.filters[1].on,n=0===this.state.filters[3].on.length?this.state.filters[3].off:this.state.filters[3].on;return this.state.foods.filter(function(o){return-1!==t.indexOf(o.maintype)&&p.arrayElementInArray(o.sidetype.split(", "),a)&&-1!==n.indexOf(o.foodamount)&&p.checkSpeedFilter(o.time,e.state.filters[2].on)&&o.name.toLowerCase().includes(e.state.textfilter.toLowerCase())})}},{key:"DropDown",value:function(e){document.getElementById(e).classList.toggle("is-nav-open"),this.setState({dropdown:0===this.state.dropdown.length?e:""})}},{key:"handleSorterClick",value:function(e){for(var t=this.state.sortBy,a=0;a<t.length;a++)t[a]=t[a].name===e?{name:e,clicked:2===t[a].order?0:Date.parse((new Date).toDateString()),order:(t[a].order+1)%3}:t[a];console.log(t),this.setState({foods:p.sortFoods(this.state.foods,t),sortBy:t})}},{key:"render",value:function(){var e=this.FilterSelected(),t=this.CreateRow("main",this.state.filters[0].off),a=this.CreateRow("side",this.state.filters[1].off),n=this.CreateRow("speed",this.state.filters[2].off),r=this.CreateRow("days",this.state.filters[3].off);return o.a.createElement("div",null,this.state.newFoodSelected?o.a.createElement(this.SetFoodParameters,null):o.a.createElement("div",{id:"main"},o.a.createElement(this.MenuItem,{name:"Filters",dropName:"filtermenu",icon:v.a}),o.a.createElement(this.MenuItem,{name:"Show",dropName:"showmenu",icon:v.e}),o.a.createElement("div",{id:"filtermenu",className:"filtermenu"},o.a.createElement("div",{className:"nav"},o.a.createElement("div",null,"filtermenu"===this.state.dropdown?o.a.createElement("div",null,o.a.createElement("form",null,o.a.createElement("input",{value:this.state.textfilter,onChange:this.updateTextFilter}))):null,"filtermenu"===this.state.dropdown?o.a.createElement("div",null,o.a.createElement(w.a,null,t)):null,"filtermenu"===this.state.dropdown?o.a.createElement("div",null,o.a.createElement(w.a,null,a)):null,"filtermenu"===this.state.dropdown?o.a.createElement("div",null,o.a.createElement(w.a,null,n)):null,"filtermenu"===this.state.dropdown?o.a.createElement("div",null,o.a.createElement(w.a,null,r)):null))),o.a.createElement("div",{id:"showmenu",className:"showmenu"},"showmenu"===this.state.dropdown?o.a.createElement("div",null,o.a.createElement(this.ToggleButton,{name:"Times Eaten"}),o.a.createElement(this.ToggleButton,{name:"Duration"}),o.a.createElement(this.ToggleButton,{name:"Last Eaten"})):null," "),o.a.createElement("div",null,o.a.createElement(w.a,null,e)),o.a.createElement("div",null,o.a.createElement("table",{id:"food-table",className:"food-table"},o.a.createElement("tbody",null,o.a.createElement("tr",null,o.a.createElement(this.TableHeader,{name:"main"}),o.a.createElement(this.TableHeader,{name:"side"}),o.a.createElement(this.TableHeader,{name:"name"}),this.state.show_timeseaten?o.a.createElement(this.TableHeader,{name:"eaten"}):null,this.state.show_duration?o.a.createElement(this.TableHeader,{name:"duration"}):null,this.state.show_lasteaten?o.a.createElement(this.TableHeader,{name:"lasteaten"}):null),o.a.createElement(this.FoodTable,{foods:this.FilteredFoods()}))))))}}]),t}(o.a.Component);s.a.render(o.a.createElement(N,null),document.getElementById("root"))}},[[35,1,2]]]);
//# sourceMappingURL=main.408d2f23.chunk.js.map