(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{35:function(e,t,a){e.exports=a(66)},56:function(e,t,a){},63:function(e,t){var a=864e5;function n(e){for(var t=600,a=0;a<e.length;a++){if("<1/2h"===e[a])return 30;"<1h"===e[a]?t=60:">1h"===e[a]&&t>100&&(t=90)}return t}function o(e){if(!e)return console.log("incorrect dayArray"),{daysMin:0,daysMinInt:0,daysMax:0,daysMaxInt:0};var t=Date.parse((new Date).toDateString()),n=Date.parse(new Date(e[0]).toDateString()),o=Date.parse(new Date(e[1]).toDateString()),r=(t-n)/a;return console.log((t-o)%a),{daysMin:r,daysMinInt:n,daysMax:(t-o)/a,daysMaxInt:o}}function r(e){if(!e)return"-";var t=o(e);console.log(t);var a=t.daysMin,n=t.daysMax;return n<=0&&a<=0?"In "+Math.round(-1*a)+" days":n<=0?"Current":Math.round(n)+" days ago"}function l(e){var t=s(e);return o(t.lastEaten).daysMaxInt<Date.parse((new Date).toDateString())?0:o(t.lasteaten).daysMax}function s(e){var t=e[0];return e.forEach(function(e){var a=r(e.lastEaten);"Current"===a&&(t=e),-1!==a.indexOf("days")&&-1<Number(a.split(" ")[1])&&(t=e)}),console.log(t),t}t.arrayElementInArray=function(e,t){for(var a=0;a<e.length;a++)for(var n=0;n<t.length;n++)if(e[a]===t[n])return!0;return!1},t.slowestFood=n,t.lastEaten=r,t.nextAvailableFreeDay=l,t.last3weeksFoods=function(e){var t=[],a=!0,n=!1,r=void 0;try{for(var l,s=e[Symbol.iterator]();!(a=(l=s.next()).done);a=!0){var i=l.value;i.lasteaten&&o(i.lasteaten).daysMax<21&&t.push(i)}}catch(c){n=!0,r=c}finally{try{a||null==s.return||s.return()}finally{if(n)throw r}}return t},t.getLatestFood=s,t.sortFoods=function(e,t){var a=[];function n(e,t,a){return e<t?1===a?-1:1:e>t?1===a?1:-1:0}var o=t.filter(function(e){return 0!==e.order}).sort(function(e,t){return t.clicked-e.clicked});return 0===o.length?e:(o.forEach(function(t){"main"===t.name?a=e.sort(function(e,a){return n(e.maintype.toLowerCase(),a.maintype.toLowerCase(),t.order)}):"side"===t.name?a=e.sort(function(e,a){return n(e.sidetype.toLowerCase(),a.sidetype.toLowerCase(),t.order)}):"name"===t.name?a=e.sort(function(e,a){return n(e.name.toLowerCase(),a.name.toLowerCase(),t.order)}):"eaten"===t.name?a=e.sort(function(e,a){return n(e.timeseaten,a.timeseaten,t.order)}):"duration"===t.name?a=e.sort(function(e,a){return n(e.foodamount,a.foodamount,t.order)}):"lasteaten"===t.name&&(a=e.sort(function(e,a){return n(e.lasteaten?Date.parse(e.lasteaten[1]):1/0,a.lasteaten?Date.parse(a.lasteaten[1]):1/0,t.order)}))}),a)},t.getStartAndEndDays=function(e,t,n,o){var r=Date.parse((new Date).toDateString()),s=r+(-1*l(e)+n)*a,i=s+o*a,c=new Date(s).toDateString(),d=new Date(i).toDateString();return console.log("today ms"+r),console.log("start ms"+s),console.log("endDay ms"+i),console.log("startDayString"+c),console.log("endDayString"+d),{obj:t,start:c,end:d}},t.shiftDay=function(e,t){return new Date(Date.parse(new Date(e))+t*a).toDateString()},t.checkSpeedFilter=function(e,t){if(!t)return!0;var a=n(t);return 90===a?e>60:30===a?e<=30:e<=60}},66:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(11),l=a.n(r),s=a(25),i=a(26),c=a(31),d=a(27),u=a(3),m=a(32),f=a(14),h=a.n(f),E=(a(56),a(28)),g=a(68),v=a(67),w=a(4),b=a(7),y=a(2),x=a(63),p="/api/foods",F=["kala","kana","kasvis","liha"],k=["bataatti","pasta","peruna","riisi","salaatti"],S=["<1/2h","<1h",">1h"],D=[1,2,3],N=function(e){return-1!==F.indexOf(e)?"main":-1!==k.indexOf(e)?"side":Object(E.isNumber)(e)?"day":"speed"};function C(e){return"liha"===e?o.a.createElement(y.a,{icon:w.c}):"kana"===e?o.a.createElement(y.a,{icon:w.g}):"kasvis"===e?o.a.createElement(y.a,{icon:w.h}):"kala"===e?o.a.createElement(y.a,{icon:w.d}):"<1/2h"===e?o.a.createElement(y.a,{icon:b.c}):"<1h"===e?o.a.createElement(y.a,{icon:w.f}):">1h"===e?o.a.createElement(y.a,{icon:w.e}):e}var j=function(e){function t(e){var a,n=this;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).FilterSelected=function(e){return(e?a.getPressedFilters().inc:a.getPressedFilters().exc).map(function(e,t){return o.a.createElement(v.a,{key:t,classNames:"filtered",timeout:{enter:500,exit:300}},o.a.createElement("button",{className:"filter-button",onClick:a.DeactivateFilter.bind(Object(u.a)(a),e),key:t},C(e),o.a.createElement(y.a,{className:"remove-filter",icon:b.d})))})},a.FilterRow=function(e){return o.a.createElement("div",null,o.a.createElement(g.a,null,o.a.createElement(v.a,{key:0,classNames:"filtered",timeout:{enter:500,exit:300}},e.off.length>0?o.a.createElement("i",null,e.name+": "):o.a.createElement("i",{visibilty:"hidden"})),a.CreateRow(e.name,e.off)))},a.CreateRow=function(e,t){return t.map(function(t,n){return o.a.createElement(v.a,{key:n,classNames:"filtered",timeout:{enter:500,exit:300}},o.a.createElement("button",{id:N(e),className:"filter-button",onClick:a.ActivateFilter.bind(Object(u.a)(a),t),key:n},C(t)))})},a.CreateRow2=function(e,t){return t.map(function(e,t){return o.a.createElement("button",{onClick:a.ActivateFilter.bind(Object(u.a)(a),e),key:t},C(e))})},a.NameLink=function(e){var t=e.food;return""===t.link?o.a.createElement("td",null,t.name):o.a.createElement("td",null,o.a.createElement("a",{href:t.link},t.name))},a.SelectFood=function(){var e=a.state.newFood.obj;console.log("syodaan nakojaan "+e.name);var t=a.state.newFood.start,n=a.state.newFood.end;e.lasteaten=[new Date(t).toDateString(),new Date(n).toDateString()],console.log(e),h.a.post(p+"/select/",e).then(function(e){console.log("updated: "+e.data),a.componentDidMount()}),a.setState({newFoodSelected:!1,dropdown:""})},a.SetFoodParameters=function(){function e(e,t){if(this.state.newFood.start!==this.state.newFood.end||!(e>0||t<0)){var a=x.shiftDay(this.state.newFood.start,e),n=x.shiftDay(this.state.newFood.end,t);this.setState({newFood:{obj:this.state.newFood.obj,start:a,end:n}}),console.log(this.state.newFood)}}function t(e){var t=new Date(e).getMonth()+1;return new Date(e).getDate()+"."+t}return o.a.createElement("div",{className:"food-adder-content"},o.a.createElement("div",{className:"fa-box"},a.state.newFood.obj.name),o.a.createElement("div",{className:"fa-box"},"Start"),o.a.createElement("i",null),o.a.createElement(y.a,{className:"fa-box",icon:b.a,onClick:e.bind(Object(u.a)(a),-1,-1)}),o.a.createElement("div",{className:"fa-box"},a.state.newFood.start.split(" ")[0]),o.a.createElement(y.a,{className:"fa-box",icon:b.b,onClick:e.bind(Object(u.a)(a),1,1)}),o.a.createElement("i",null),o.a.createElement("div",{className:"fa-box"},t(a.state.newFood.start)),o.a.createElement("div",{className:"fa-box"},"End"),o.a.createElement("i",null),o.a.createElement(y.a,{className:"fa-box",icon:b.a,onClick:e.bind(Object(u.a)(a),0,-1)}),o.a.createElement("div",{className:"fa-box"},a.state.newFood.end.split(" ")[0]),o.a.createElement(y.a,{className:"fa-box",icon:b.b,onClick:e.bind(Object(u.a)(a),0,1)}),o.a.createElement("i",null),o.a.createElement("div",{className:"fa-box"},t(a.state.newFood.end)),o.a.createElement("div",{className:"fa-box",onClick:function(){return a.setState({newFoodSelected:!1,dropdown:""})}},"Cancel"),o.a.createElement("i",null),o.a.createElement("div",{className:"fa-box",onClick:a.SelectFood.bind(Object(u.a)(a))},"Ok"))},a.FoodTable=function(e){return e.foods.map(function(e,t){return o.a.createElement("tr",{key:t},o.a.createElement("td",{className:"maintype_table"},C(e.maintype)),o.a.createElement("td",{className:"sidetype_table"},e.sidetype),o.a.createElement(n.NameLink,{food:e}),a.state.show_timeseaten?o.a.createElement("td",null,e.timeseaten):null,a.state.show_duration?o.a.createElement("td",null,e.foodamount):null,a.state.show_lasteaten?o.a.createElement("td",null,x.lastEaten(e.lasteaten)):null,o.a.createElement("td",{onClick:function(){document.getElementById("food-table").classList.toggle("set-to-background"),a.setState({newFoodSelected:!0,newFood:x.getStartAndEndDays(a.state.foods,e,0,e.foodamount)})}},o.a.createElement(y.a,{icon:w.i,className:"select-food-button"})))})},a.updateTextFilter=function(e){a.setState({textfilter:e.target.value})},a.ToggleButton=function(e){var t=e.name;return o.a.createElement("div",null,o.a.createElement("p",{id:"toggleButton-text",className:"toggleButton-text",onClick:function(e){document.getElementById(e).classList.toggle("active"),document.getElementById("toggleButton-text").classList.toggle("pressed"),"Times Eaten"===e?this.setState({show_timeseaten:!this.state.show_timeseaten}):"Duration"===e?this.setState({show_duration:!this.state.show_duration}):this.setState({show_lasteaten:!this.state.show_lasteaten})}.bind(Object(u.a)(a),t)},t),o.a.createElement("div",{id:t,className:"toggleButton"},o.a.createElement("div",{className:"inner-Circle"})))},a.MenuItem=function(e){var t=e.name,n=e.dropName,r=e.icon;function l(){var e=this.state.dropdown;document.getElementById(n).classList.toggle("is-nav-open"),this.setState({dropdown:e===n?"":n}),e!==n&&e.length>0&&document.getElementById(e).classList.toggle("is-nav-open")}return o.a.createElement("i",{className:"menu-text",onClick:l.bind(Object(u.a)(a),l)},o.a.createElement(y.a,{icon:r})," "+t)},a.TableHeader=function(e){var t=e.name,n=void 0;return a.state.sortBy.forEach(function(e){e.name===t&&(n=e)}),o.a.createElement("th",null,o.a.createElement("i",{className:"table-header",onClick:a.handleSorterClick.bind(Object(u.a)(a),t)},"lasteaten"===t?"Last Eaten":t+" ",1===n.order?o.a.createElement(y.a,{icon:w.l}):2===n.order?o.a.createElement(y.a,{icon:w.m}):o.a.createElement(y.a,{icon:w.k})))},a.state={foods:[],newFoodSelected:!1,newFood:{obj:null,start:0,end:1},latestfoods:[],filtersPressed:[],filters:[{name:"main",on:{include:[],exclude:[]},off:F},{name:"side",on:{include:[],exclude:[]},off:k},{name:"speed",on:{include:[],exclude:[]},off:S},{name:"day",on:{include:[],exclude:[]},off:D}],textfilter:"",dropdown:"",show_timeseaten:!1,show_duration:!1,show_lasteaten:!1,selectingFood:{bool:!1,newFood:null},sortBy:[{name:"main",clicked:0,order:0},{name:"side",clicked:0,order:0},{name:"name",clicked:0,order:0},{name:"eaten",clicked:0,order:0},{name:"duration",clicked:0,order:0},{name:"lasteaten",clicked:0,order:0}],filterIncludeExclude:!0},a.SetFoodParameters=a.SetFoodParameters.bind(Object(u.a)(a)),a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;console.log("mounttas"),h.a.get(p).then(function(t){e.setState({foods:t.data})})}},{key:"DeactivateFilter",value:function(e,t){for(var a=this.state.filters,n=0;n<a.length;n++)a[n]=a[n].name===N(e)?{name:a[n].name,on:{include:a[n].on.include.filter(function(t){return t!==e}),exclude:a[n].on.exclude.filter(function(t){return t!==e})},off:a[n].off.concat(e).sort()}:a[n];this.setState({filtersPressed:this.state.filtersPressed.filter(function(t){return t!==e}),filters:a})}},{key:"ActivateFilter",value:function(e){for(var t=this.state.filters,a=0;a<t.length;a++)t[a]=t[a].name===N(e)?{name:t[a].name,on:this.state.filterIncludeExclude?{include:t[a].on.include.concat(e),exclude:t[a].on.exclude}:{include:t[a].on.include,exclude:t[a].on.exclude.concat(e)},off:t[a].off.filter(function(t){return t!==e})}:t[a];this.setState({filtersPressed:this.state.filtersPressed.concat(e).sort(),filters:t})}},{key:"getPressedFilters",value:function(){var e=[],t=[];return this.state.filters.map(function(t){return t.on.include.forEach(function(t){return e.push(t)})}),this.state.filters.map(function(e){return e.on.exclude.forEach(function(e){return t.push(e)})}),{inc:e,exc:t}}},{key:"FilteredFoods",value:function(){var e=this;if(0===this.state.filtersPressed.length&&0===this.state.textfilter.length)return this.state.foods;var t={inc:0===this.state.filters[0].on.include.length?this.state.filters[0].off:this.state.filters[0].on.include,exc:this.state.filters[0].on.exclude};console.log(t);var a={inc:0===this.state.filters[1].on.include.length?this.state.filters[1].off:this.state.filters[1].on.include,exc:this.state.filters[1].on.exclude},n={inc:0===this.state.filters[3].on.include.length?this.state.filters[3].off:this.state.filters[3].on.include,exc:this.state.filters[3].on.exclude};return this.state.foods.filter(function(o){return-1!==t.inc.indexOf(o.maintype)&&-1===t.exc.indexOf(o.maintype)&&x.arrayElementInArray(o.sidetype.split(", "),a.inc)&&!x.arrayElementInArray(o.sidetype.split(", "),a.exc)&&-1!==n.inc.indexOf(o.foodamount)&&-1===n.exc.indexOf(o.foodamount)&&x.checkSpeedFilter(o.time,e.state.filters[2].on.include)&&(0===e.state.filters[2].on.exclude.length||!x.checkSpeedFilter(o.time,e.state.filters[2].on.exclude))&&o.name.toLowerCase().includes(e.state.textfilter.toLowerCase())})}},{key:"DropDown",value:function(e){document.getElementById(e).classList.toggle("is-nav-open"),this.setState({dropdown:0===this.state.dropdown.length?e:""})}},{key:"handleSorterClick",value:function(e){for(var t=this.state.sortBy,a=0;a<t.length;a++)t[a]=t[a].name===e?{name:e,clicked:2===t[a].order?0:Date.parse((new Date).toDateString()),order:(t[a].order+1)%3}:t[a];console.log(t),this.setState({foods:x.sortFoods(this.state.foods,t),sortBy:t})}},{key:"render",value:function(){var e=this,t=this.FilterSelected(!0),a=this.FilterSelected(!1),n=this.FilterRow(this.state.filters[0]),r=this.FilterRow(this.state.filters[1]),l=this.FilterRow(this.state.filters[2]),s=this.FilterRow(this.state.filters[3]);return o.a.createElement("div",null,this.state.newFoodSelected?o.a.createElement(this.SetFoodParameters,null):o.a.createElement("div",{id:"main"},o.a.createElement(this.MenuItem,{name:"Filters",dropName:"filtermenu",icon:w.a}),o.a.createElement(this.MenuItem,{name:"Show",dropName:"showmenu",icon:w.j}),o.a.createElement("div",{id:"filtermenu",className:"filtermenu"},o.a.createElement("div",{className:"nav"},o.a.createElement("div",null,"filtermenu"===this.state.dropdown?o.a.createElement("div",null,o.a.createElement("div",{className:"form"},o.a.createElement("form",{className:"form"},o.a.createElement("input",{value:this.state.textfilter,onChange:this.updateTextFilter})),o.a.createElement("div",{className:"form"},o.a.createElement(y.a,{icon:w.n,onClick:function(){e.setState({textfilter:""})}}))),n,r,l,s,o.a.createElement("div",{className:"include-exclude",onClick:function(){console.log(e.getPressedFilters()),e.setState({filterIncludeExclude:!e.state.filterIncludeExclude})}},o.a.createElement("div",{className:"include-exclude-inner"},this.state.filterIncludeExclude?o.a.createElement("div",{className:"include"},o.a.createElement(y.a,{icon:w.b}),o.a.createElement("i",null,"Must Include")," "):o.a.createElement("div",{className:"exclude"},o.a.createElement(y.a,{icon:w.n}),o.a.createElement("i",null,"Exclude")," ")))):null))),o.a.createElement("div",{id:"showmenu",className:"showmenu"},"showmenu"===this.state.dropdown?o.a.createElement("div",null,o.a.createElement(this.ToggleButton,{name:"Times Eaten"}),o.a.createElement(this.ToggleButton,{name:"Duration"}),o.a.createElement(this.ToggleButton,{name:"Last Eaten"})):null," "),o.a.createElement("div",null,o.a.createElement(g.a,null,o.a.createElement(v.a,{key:0,classNames:"filtered",timeout:{enter:500,exit:300}},this.getPressedFilters().inc.length>0?o.a.createElement(y.a,{icon:w.b,className:"filtered"}):o.a.createElement("i",null)),t),o.a.createElement(g.a,null,o.a.createElement(v.a,{key:0,classNames:"filtered",timeout:{enter:500,exit:300}},this.getPressedFilters().exc.length>0?o.a.createElement(y.a,{icon:w.n,className:"filtered"}):o.a.createElement("i",null)),a)),o.a.createElement("div",null,o.a.createElement("table",{id:"food-table",className:"food-table"},o.a.createElement("tbody",null,o.a.createElement("tr",{className:"table-headers"},o.a.createElement(this.TableHeader,{name:"main"}),o.a.createElement(this.TableHeader,{name:"side"}),o.a.createElement(this.TableHeader,{name:"name"}),this.state.show_timeseaten?o.a.createElement(this.TableHeader,{name:"eaten"}):null,this.state.show_duration?o.a.createElement(this.TableHeader,{name:"duration"}):null,this.state.show_lasteaten?o.a.createElement(this.TableHeader,{name:"lasteaten"}):null),o.a.createElement(this.FoodTable,{foods:this.FilteredFoods()}))))))}}]),t}(o.a.Component);l.a.render(o.a.createElement(j,null),document.getElementById("root"))}},[[35,1,2]]]);
//# sourceMappingURL=main.78b30953.chunk.js.map